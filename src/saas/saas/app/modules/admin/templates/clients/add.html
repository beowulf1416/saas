{% extends "saas.app.modules.admin:templates/default.html" %}

{% block title %}
Administer Clients - New Client
{% endblock title %}

{% block content %}
<h1>New Client</h1>
<div class="notifications-wrapper">
    <notification-list></notification-list>
</div><!-- .notifications-wrapper -->
<div class="client-wrapper">
    <form class="form-client">
        <fieldset>
            <div class="form-group">
                <label for="name">Name</label>
                <input type="text" id="name" name="name" class="form-input-text form-input-name" title="Client Name" placeholder="Name" />
            </div><!-- .form-group -->
            <div class="form-group">
                <label for="address">Address</label>
                <textarea id="address" name="address" class="form-input-textarea form-input-address" title="Client Address" placeholder="Address"></textarea>
            </div><!-- .form-group -->
        </fieldset>
        <fieldset>
            <div class="form-group">
                <label for="url">URL Friendly Name</label>
                <input type="text" id="url" name="url" class="form-input-text form-input-url" title="URL Friendly Name" placeholder="URL Friendly Name" pattern="^[a-z0-9._+-]+$"/>
                <div class="text-help">Only lowercase letters and numbers are allowed. No spaces and symbols.</div>
            </div><!-- .form-group -->
        </fieldset>
        <button type="button" id="save" class="btn btn-primary" title="Save">Save</button>
        <button type="button" id="cancel" class="btn" title="Cancel">Cancel</button>
    </form><!-- .form-client -->
</div><!-- .client-wrapper -->
{% endblock content %}

{% block scripts %}
<script type="module" src="/static/js/components/notification.list.js"></script>
<script type="module" src="/static/js/helpers/clients.js"></script>
<script type="module">
'use strict';
import { Clients } from '/static/js/helpers/clients.js';
(function(){
    const notifier = document.querySelector('notification-list');
    const btnSave = document.querySelector('button#save');
    btnSave.addEventListener('click', function(e) {
        const txtName = document.querySelector('input#name');
        const txtAddr = document.querySelector('textarea#address');
        const txtUrl = document.querySelector('input#url');
        Clients.add(txtName.value, txtAddr.value, txtUrl.value).then((r) => {
            if (r.status == 'success') {
                window.location = '/admin/clients/list';
            } else {
                notifier.add('error', r.message);
            }
        });
    });

    const btnCancel = document.querySelector('button#cancel');
    btnCancel.addEventListener('click', function(e) {
        window.location = '/admin/clients/list';
    });
})();
</script>
{% endblock scripts %}